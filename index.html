<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>DIARIO DE TRADE - Remora Trader</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .form-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            height: fit-content;
        }

        .form-card h2 {
            margin-bottom: 20px;
            color: #333;
            font-size: 1.5rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e8ff;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.3s ease;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #e0e8ff;
            color: #667eea;
            margin-top: 10px;
        }

        .btn-secondary:hover {
            background: #d0d8ef;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            border: none;
            padding: 12px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .export-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #e0e8ff;
        }

        .export-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .privacy-note {
            background: #e8f5e8;
            border: 1px solid #4CAF50;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: #2e7d32;
        }

        .privacy-note strong {
            color: #1b5e20;
        }

        .dashboard {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: linear-gradient(135deg, #f8f9ff 0%, #e8f0ff 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #e0e8ff;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }

        .metric-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        .positive {
            color: #4CAF50;
        }

        .negative {
            color: #f44336;
        }

        .calendar-container {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #e0e8ff;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .month-nav {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .month-nav:hover {
            background: #5a6fd8;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-header-cell {
            text-align: center;
            font-weight: bold;
            padding: 10px 5px;
            color: #666;
            font-size: 0.9rem;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 60px;
            position: relative;
        }

        .calendar-day:hover {
            transform: scale(1.05);
            z-index: 10;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .calendar-day.other-month {
            opacity: 0.3;
        }

        .calendar-day.profit {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .calendar-day.loss {
            background: linear-gradient(135deg, #f44336, #e53935);
            color: white;
        }

        .calendar-day.neutral {
            background: #e0e8ff;
            color: #666;
        }

        .day-number {
            font-weight: bold;
            font-size: 0.9rem;
        }

        .day-pnl {
            font-size: 0.7rem;
            margin-top: 2px;
            font-weight: 500;
        }

        .trades-list {
            margin-bottom: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .trade-item {
            background: #f8f9ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .trade-item.profit {
            border-left-color: #4CAF50;
        }

        .trade-item.loss {
            border-left-color: #f44336;
        }

        .trade-info {
            flex: 1;
        }

        .trade-symbol {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .trade-details {
            font-size: 0.9rem;
            color: #666;
            margin-top: 2px;
        }

        .trade-result {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .delete-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 10px;
        }

        .delete-btn:hover {
            background: #ff3742;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            font-size: 0.9rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .quick-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .quick-btn {
            padding: 10px;
            border: 2px solid #e0e8ff;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            font-weight: 600;
        }

        .quick-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .quick-btn:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .quick-btn.active:hover {
            background: #5a6fd8;
        }

        /* Dark mode styles */
        body.dark {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
        }

        .dark .form-card,
        .dark .dashboard {
            background: #2c2c54;
            color: #e0e0e0;
        }

        .dark .metric-card {
            background: linear-gradient(135deg, #3c3c6e 0%, #2c2c54 100%);
            border-color: #4a4a7a;
        }

        .dark .calendar-container {
            background: #3c3c6e;
            border-color: #4a4a7a;
        }

        .dark .form-group input,
        .dark .form-group select {
            background: #3c3c6e;
            border-color: #4a4a7a;
            color: #e0e0e0;
        }

        .dark .form-group input:focus,
        .dark .form-group select:focus {
            border-color: #667eea;
        }

        .dark .trade-item {
            background: #3c3c6e;
            color: #e0e0e0;
        }

        .dark .quick-btn {
            background: #3c3c6e;
            border-color: #4a4a7a;
            color: #e0e0e0;
        }

        .dark .quick-btn:hover {
            background: #4a4a7a;
            border-color: #667eea;
        }

        .dark .privacy-note {
            background: #2c4a2c;
            border-color: #4CAF50;
            color: #81c784;
        }

        .dark .theme-toggle {
            background: rgba(44,44,84,0.9);
            color: #e0e0e0;
        }

        .unauthorized {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #ff4757;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 999999;
            font-size: 2rem;
            text-align: center;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .calendar-day {
                min-height: 45px;
            }
            
            .day-pnl {
                font-size: 0.6rem;
            }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="_0x4f2a8c()" title="Alternar tema">🌙</button>
    
    <div class="container">
        <div class="header">
            <h1>📊 DIÁRIO DE TRADE</h1>
            <h2 style="font-size: 1.5rem; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">REMORA TRADER</h2>
            <p>Registre seus trades e acompanhe sua performance de forma simples</p>
        </div>

        <div class="main-content">
            <div class="form-card">
                <div class="privacy-note">
                    <strong>🔒 100% Privado:</strong> Seus dados ficam apenas no seu dispositivo. Nós nunca temos acesso às suas informações de trading. Funciona offline!
                </div>

                <h2>➕ Novo Trade</h2>
                
                <div class="quick-buttons">
                    <div class="quick-btn" onclick="_0x8d5f91('profit')">✅ Lucro</div>
                    <div class="quick-btn" onclick="_0x8d5f91('loss')">❌ Prejuízo</div>
                </div>

                <form id="tradeForm">
                    <div class="form-group">
                        <label for="symbol">Ativo</label>
                        <input type="text" id="symbol" name="symbol" placeholder="Ex: PETR4, VALE3, WINV25" list="assets" required>
                        <datalist id="assets">
                            <option value="PETR4">PETR4 - Petrobras</option>
                            <option value="VALE3">VALE3 - Vale</option>
                            <option value="ITUB4">ITUB4 - Itaú</option>
                            <option value="BBDC4">BBDC4 - Bradesco</option>
                            <option value="MGLU3">MGLU3 - Magazine Luiza</option>
                            <option value="WINV25">WINV25 - Mini Índice (pontos)</option>
                            <option value="WDOV25">WDOV25 - Mini Dólar (pontos)</option>
                            <option value="EURV25">EURV25 - Mini Euro (pontos)</option>
                            <option value="BTCUSD">BTCUSD - Bitcoin</option>
                            <option value="ETHUSD">ETHUSD - Ethereum</option>
                            <option value="EURUSD">EURUSD - Euro/Dólar (pips)</option>
                            <option value="GBPUSD">GBPUSD - Libra/Dólar (pips)</option>
                        </datalist>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="entryTime">Hora Entrada</label>
                            <input type="time" id="entryTime" name="entryTime">
                        </div>
                        <div class="form-group">
                            <label for="exitTime">Hora Saída</label>
                            <input type="time" id="exitTime" name="exitTime">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="entryPrice">Preço Entrada</label>
                            <input type="number" id="entryPrice" name="entryPrice" step="0.01" placeholder="25.50" required>
                        </div>
                        <div class="form-group">
                            <label for="exitPrice">Preço Saída</label>
                            <input type="number" id="exitPrice" name="exitPrice" step="0.01" placeholder="26.00" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="quantity">Quantidade</label>
                            <input type="number" id="quantity" name="quantity" placeholder="100" required>
                        </div>
                        <div class="form-group">
                            <label for="currency">Unidade</label>
                            <select id="currency" name="currency">
                                <option value="BRL">R$ (Reais)</option>
                                <option value="USD">US$ (Dólares)</option>
                                <option value="PTS">Pontos</option>
                                <option value="PIPS">Pips</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="result">Resultado</label>
                        <input type="number" id="result" name="result" step="0.01" placeholder="50.00" required>
                    </div>

                    <div class="form-group">
                        <label for="date">Data</label>
                        <input type="date" id="date" name="date" required>
                    </div>

                    <div class="form-group">
                        <label for="notes">Observações (opcional)</label>
                        <input type="text" id="notes" name="notes" placeholder="Ex: Setup rompimento, stop hit, etc.">
                    </div>

                    <button type="submit" class="btn">💾 Salvar Trade</button>
                    <button type="button" class="btn btn-secondary" onclick="_0x2c3d45()">🗑️ Limpar</button>
                </form>

                <div class="trades-list" id="tradesList">
                    <h3>Últimos Trades</h3>
                    <div id="tradesContainer">
                        <p style="text-align: center; color: #666; margin: 20px 0;">Nenhum trade registrado ainda</p>
                    </div>
                </div>

                <div class="export-section">
                    <h3>💾 Backup dos Dados</h3>
                    <div class="export-buttons">
                        <button class="btn btn-secondary btn-small" onclick="_0x9a7e6f()">📥 Baixar Backup</button>
                        <button class="btn btn-secondary btn-small" onclick="document.getElementById('importFile').click()">📤 Restaurar Backup</button>
                    </div>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="_0x6c8b4d(event)">
                    <p style="font-size: 0.8rem; color: #666; margin-top: 10px; text-align: center;">
                        Faça backup regular dos seus dados para não perder seu histórico
                    </p>
                </div>
            </div>

            <div class="dashboard">
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="totalPnL">0</div>
                        <div class="metric-label">P&L Total</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="winRate">0%</div>
                        <div class="metric-label">Win Rate</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="totalTrades">0</div>
                        <div class="metric-label">Total Trades</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="bestDay">0</div>
                        <div class="metric-label">Melhor Dia</div>
                    </div>
                </div>

                <div class="calendar-container">
                    <div class="calendar-header">
                        <button class="month-nav" onclick="_0x5e9a2c(-1)">← Anterior</button>
                        <h2 id="currentMonth">Julho 2025</h2>
                        <button class="month-nav" onclick="_0x5e9a2c(1)">Próximo →</button>
                    </div>
                    
                    <div class="calendar-grid" id="calendar">
                        <!-- Calendar will be generated here -->
                    </div>
                    
                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background: linear-gradient(135deg, #4CAF50, #45a049);"></div>
                            <span>Lucro</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: linear-gradient(135deg, #f44336, #e53935);"></div>
                            <span>Prejuízo</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #e0e8ff;"></div>
                            <span>Sem trades</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // =================== PROTEÇÃO ANTI-CLONE ===================
        
        const _0x3a8f = ['localhost', 'tradingdiary', 'vercel.app', 'netlify.app', '127.0.0.1'];
        const _0x5b2e = window.location.hostname;
        const _0x7c9d = document.referrer;
        let _0x4e6a = false;
        
        // =================== PROTEÇÃO ANTI-CLONE ===================
        
        const _0x3a8f = ['localhost', '127.0.0.1'];
        const _0x5b2e = window.location.hostname;
        const _0x7c9d = document.referrer;
        let _0x4e6a = false;
        
        // Strict domain protection
        function _0x1f8e() {
            const _0x8a3b = 'diariotrading.vercel.app';
            
            // Development only
            for(let i = 0; i < _0x3a8f.length; i++) {
                if(_0x5b2e.includes(_0x3a8f[i])) {
                    _0x4e6a = true;
                    break;
                }
            }
            
            // Production domain
            if(_0x5b2e === _0x8a3b) {
                _0x4e6a = true;
            }
            
            if(!_0x4e6a) {
                _0x9f2e();
                return false;
            }
            return true;
        }
        
        // Anti-tamper protection
        function _0x9f2e() {
            document.body.innerHTML = '<div class="unauthorized">🚫 ERRO 403<br><small>Acesso negado</small></div>';
            setInterval(() => {
                console.clear();
                console.log('%cERRO', 'color: red; font-size: 20px;');
            }, 500);
            setTimeout(() => window.location.href = 'about:blank', 3000);
        }
        
        // Anti-debug protection
        let _0x2a5f = false;
        setInterval(() => {
            const _0x6e8c = new Date();
            debugger;
            if(new Date() - _0x6e8c > 100) {
                _0x2a5f = true;
                _0x9f2e();
            }
        }, 1000);
        
        // Integrity check
        function _0x8c4e() {
            const _0x3f7a = document.scripts.length;
            const _0x9b1d = document.querySelectorAll('*').length;
            const _0x4c8e = btoa(_0x5b2e + navigator.userAgent.slice(0,20));
            return btoa(_0x3f7a + _0x9b1d + _0x5b2e.length + _0x4c8e.length);
        }
        
        const _0x6f3e = _0x8c4e();
        
        // Advanced protection
        let _0x8f9e = 0;
        const _0x7d2a = setInterval(() => {
            _0x8f9e++;
            if(_0x8f9e > 100 && (_0x2a5f || _0x8c4e() !== _0x6f3e)) {
                _0x9f2e();
                clearInterval(_0x7d2a);
            }
        }, 1000);
        
        // Code injection protection
        const _0x9e4f = document.querySelector.toString();
        setInterval(() => {
            if(document.querySelector.toString() !== _0x9e4f) {
                _0x9f2e();
            }
        }, 2000);
        
        // Initialize protection
        if(!_0x1f8e()) {
            throw new Error('X1001');
        }
        
        // Anti-bypass protection
        Object.defineProperty(window, '_0x9f2e', { value: _0x9f2e, writable: false });
        Object.defineProperty(window, '_0x1f8e', { value: _0x1f8e, writable: false });
        
        // =================== APLICAÇÃO PRINCIPAL (OFUSCADA) ===================
        
        let _0x7f4e = JSON.parse(localStorage.getItem('_0x9d2a') || '[]');
        let _0x3c8f = new Date();
        let _0x5a7c = {};
        let _0x8e9f = localStorage.getItem('_0x7e8d') || 'BRL'; // Default currency
        
        // Set today's date as default
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        document.getElementById('date').valueAsDate = today;
        document.getElementById('currency').value = _0x8e9f;
        
        // Theme handler
        function _0x4f2a8c() {
            if(_0x8c4e() !== _0x6f3e) { _0x9f2e(); return; }
            
            const _0x8e5d = document.body;
            const _0x2f6a = document.querySelector('.theme-toggle');
            
            _0x8e5d.classList.toggle('dark');
            const _0x4b9e = _0x8e5d.classList.contains('dark');
            
            _0x2f6a.textContent = _0x4b9e ? '☀️' : '🌙';
            localStorage.setItem('_0x4d8f', _0x4b9e);
        }
        
        // Currency change handler
        document.getElementById('currency').addEventListener('change', function(e) {
            if(_0x2a5f) { _0x9f2e(); return; }
            
            _0x8e9f = e.target.value;
            localStorage.setItem('_0x7e8d', _0x8e9f);
            
            // Update placeholder
            const _0x5f9d = document.getElementById('result');
            switch(_0x8e9f) {
                case 'BRL':
                    _0x5f9d.placeholder = '50.00';
                    break;
                case 'USD':
                    _0x5f9d.placeholder = '10.50';
                    break;
                case 'PTS':
                    _0x5f9d.placeholder = '25.0';
                    break;
                case 'PIPS':
                    _0x5f9d.placeholder = '15.5';
                    break;
            }
            
            // Refresh display and recalculate
            _0x3d8e();
            _0x6c9e();
        });

        // Load saved theme
        const savedTheme = localStorage.getItem('_0x4d8f');
        if (savedTheme === 'true') {
            document.body.classList.add('dark');
            document.querySelector('.theme-toggle').textContent = '☀️';
        }

        // Make sure variables are properly initialized
        if (!_0x7f4e) _0x7f4e = [];
        if (!_0x5a7c) _0x5a7c = {};
        if (!_0x8e9f) _0x8e9f = 'BRL';
        
        // Export function
        function _0x9a7e6f() {
            if(_0x2a5f) { _0x9f2e(); return; }
            
            const _0x4a8d = {
                _0x7f4e: _0x7f4e,
                _0x2e6f: new Date().toISOString(),
                _0x8c9d: '2.0',
                _0x5f7e: btoa(_0x5b2e)
            };
            
            const _0x6b3a = JSON.stringify(_0x4a8d, null, 2);
            const _0x9d7c = new Blob([_0x6b3a], {type: 'application/json'});
            
            const _0x3e8f = document.createElement('a');
            _0x3e8f.href = URL.createObjectURL(_0x9d7c);
            _0x3e8f.download = `trading-diary-backup-${new Date().toISOString().split('T')[0]}.json`;
            _0x3e8f.click();
            
            const _0x5c2a = event.target;
            const _0x8f6d = _0x5c2a.textContent;
            _0x5c2a.textContent = '✅ Baixado!';
            setTimeout(() => {
                _0x5c2a.textContent = _0x8f6d;
            }, 2000);
        }
        
        // Import function
        function _0x6c8b4d(event) {
            if(_0x8c4e() !== _0x6f3e) { _0x9f2e(); return; }
            
            const _0x4f9e = event.target.files[0];
            if (!_0x4f9e) return;
            
            const _0x2c7f = new FileReader();
            _0x2c7f.onload = function(e) {
                try {
                    const _0x6a8e = JSON.parse(e.target.result);
                    
                    if (_0x6a8e._0x7f4e && Array.isArray(_0x6a8e._0x7f4e)) {
                        const _0x9e4d = confirm(
                            `Restaurar backup com ${_0x6a8e._0x7f4e.length} trades?\n` +
                            `Data do backup: ${new Date(_0x6a8e._0x2e6f).toLocaleDateString('pt-BR')}\n\n` +
                            `⚠️ Isso substituirá todos os dados atuais!`
                        );
                        
                        if (_0x9e4d) {
                            _0x7f4e = _0x6a8e._0x7f4e;
                            localStorage.setItem('_0x9d2a', JSON.stringify(_0x7f4e));
                            _0x3d8e();
                            
                            alert('✅ Backup restaurado com sucesso!');
                        }
                    } else {
                        alert('❌ Arquivo de backup inválido!');
                    }
                } catch (error) {
                    alert('❌ Erro ao ler arquivo de backup!');
                }
            };
            _0x2c7f.readAsText(_0x4f9e);
            
            event.target.value = '';
        }
        
        // Form handling
        document.getElementById('tradeForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if(_0x2a5f || _0x8c4e() !== _0x6f3e) { _0x9f2e(); return; }
            
            const _0x5e7d = new FormData(e.target);
            const _0x4c9a = {
                id: Date.now(),
                symbol: _0x5e7d.get('symbol').toUpperCase(),
                entryPrice: parseFloat(_0x5e7d.get('entryPrice')),
                exitPrice: parseFloat(_0x5e7d.get('exitPrice')),
                quantity: parseInt(_0x5e7d.get('quantity')),
                result: parseFloat(_0x5e7d.get('result')),
                currency: _0x5e7d.get('currency'),
                date: _0x5e7d.get('date'),
                entryTime: _0x5e7d.get('entryTime') || '',
                exitTime: _0x5e7d.get('exitTime') || '',
                notes: _0x5e7d.get('notes') || '',
                timestamp: new Date().toISOString(),
                _0x8f2d: btoa(_0x5b2e)
            };

            _0x7f4e.push(_0x4c9a);
            localStorage.setItem('_0x9d2a', JSON.stringify(_0x7f4e));
            
            _0x3d8e();
            _0x2c3d45();
            
            const _0x6e8a = e.target.querySelector('button[type="submit"]');
            const _0x9f7c = _0x6e8a.textContent;
            _0x6e8a.textContent = '✅ Salvo!';
            _0x6e8a.style.background = '#4CAF50';
            
            setTimeout(() => {
                _0x6e8a.textContent = _0x9f7c;
                _0x6e8a.style.background = '';
            }, 1500);
        });

        function _0x8d5f91(type) {
            if(_0x2a5f) { _0x9f2e(); return; }
            
            const _0x5a3d = document.querySelectorAll('.quick-btn');
            _0x5a3d.forEach(btn => btn.classList.remove('active'));
            
            if (type === 'profit') {
                _0x5a3d[0].classList.add('active');
                document.getElementById('result').style.borderColor = '#4CAF50';
            } else {
                _0x5a3d[1].classList.add('active');
                document.getElementById('result').style.borderColor = '#f44336';
            }
        }

        function _0x2c3d45() {
            if(_0x8c4e() !== _0x6f3e) { _0x9f2e(); return; }
            
            document.getElementById('tradeForm').reset();
            
            // Always set today's date as default
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            document.getElementById('date').valueAsDate = today;
            
            document.getElementById('currency').value = _0x8e9f; // Maintain currency selection
            document.querySelectorAll('.quick-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('result').style.borderColor = '';
            
            document.getElementById('entryTime').value = '';
            document.getElementById('exitTime').value = '';
            document.getElementById('notes').value = '';
        }

        function _0x6e4f8a(id) {
            if(_0x2a5f) { _0x9f2e(); return; }
            
            if (confirm('Tem certeza que deseja excluir este trade?')) {
                _0x7f4e = _0x7f4e.filter(trade => trade.id !== id);
                localStorage.setItem('_0x9d2a', JSON.stringify(_0x7f4e));
                _0x3d8e();
            }
        }

        function _0x3d8e() {
            try {
                if(_0x8c4e() !== _0x6f3e) { _0x9f2e(); return; }
                
                _0x8f4c(); // Calculate daily P&L
                _0x2e6d(); // Update metrics
                _0x9c3a(); // Update trades list
                _0x7b5e(); // Update calendar
            } catch(error) {
                console.error('Dashboard update error:', error);
                // Fallback - try updating again
                setTimeout(() => {
                    try {
                        _0x8f4c();
                        _0x2e6d();
                        _0x9c3a();
                        _0x7b5e();
                    } catch(e) {
                        console.error('Fallback update failed:', e);
                    }
                }, 1000);
            }
        }

        function _0x8f4c() {
            if(_0x8c4e() !== _0x6f3e) { _0x9f2e(); return; }
            
            _0x5a7c = {};
            _0x7f4e.forEach(trade => {
                const date = trade.date;
                if (!_0x5a7c[date]) {
                    _0x5a7c[date] = 0;
                }
                _0x5a7c[date] += trade.result;
            });
        }

        function _0x2e6d() {
            const _0x4f8e = _0x7f4e.reduce((sum, trade) => sum + trade.result, 0);
            const _0x6a9c = _0x7f4e.filter(trade => trade.result > 0).length;
            const _0x8d3f = _0x7f4e.filter(trade => trade.result < 0).length;
            const _0x5c7a = _0x7f4e.length > 0 ? (_0x6a9c / _0x7f4e.length) * 100 : 0;
            
            const _0x9e6b = Object.values(_0x5a7c);
            const _0x3f9d = _0x9e6b.length > 0 ? Math.max(..._0x9e6b) : 0;
            const _0x7c8e = _0x9e6b.length > 0 ? Math.min(..._0x9e6b) : 0;

            document.getElementById('totalPnL').textContent = _0x4e9f(_0x4f8e);
            document.getElementById('totalPnL').className = 'metric-value ' + (_0x4f8e >= 0 ? 'positive' : 'negative');
            
            document.getElementById('winRate').textContent = _0x5c7a.toFixed(1) + '%';
            document.getElementById('totalTrades').textContent = _0x7f4e.length;
            document.getElementById('bestDay').textContent = _0x4e9f(_0x3f9d);
            
            document.getElementById('totalPnL').title = `Média por trade: ${_0x4e9f(_0x7f4e.length > 0 ? _0x4f8e / _0x7f4e.length : 0)}`;
            document.getElementById('winRate').title = `Vitórias: ${_0x6a9c} | Perdas: ${_0x8d3f}`;
            document.getElementById('bestDay').title = `Pior dia: ${_0x4e9f(_0x7c8e)}`;
        }

        function _0x9c3a() {
            if(_0x8c4e() !== _0x6f3e) { _0x9f2e(); return; }
            
            const container = document.getElementById('tradesContainer');
            
            if (_0x7f4e.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; margin: 20px 0;">Nenhum trade registrado ainda</p>';
                return;
            }

            const lastTrades = _0x7f4e.slice(-5).reverse();
            
            container.innerHTML = lastTrades.map(trade => {
                const timeInfo = trade.entryTime || trade.exitTime ? 
                    `• ${trade.entryTime || '?'} → ${trade.exitTime || '?'}` : '';
                const notesInfo = trade.notes ? `<br><small>📝 ${trade.notes}</small>` : '';
                
                // Format result with trade's currency
                const tradeCurrency = trade.currency || 'BRL';
                let resultText = '';
                switch(tradeCurrency) {
                    case 'BRL':
                        resultText = new Intl.NumberFormat('pt-BR', {
                            style: 'currency',
                            currency: 'BRL'
                        }).format(trade.result);
                        break;
                    case 'USD':
                        resultText = new Intl.NumberFormat('en-US', {
                            style: 'currency',
                            currency: 'USD'
                        }).format(trade.result);
                        break;
                    case 'PTS':
                        resultText = `${trade.result >= 0 ? '' : '-'}${Math.abs(trade.result).toFixed(1)} pts`;
                        break;
                    case 'PIPS':
                        resultText = `${trade.result >= 0 ? '' : '-'}${Math.abs(trade.result).toFixed(1)} pips`;
                        break;
                    default:
                        resultText = trade.result.toFixed(2);
                }
                
                return `
                    <div class="trade-item ${trade.result >= 0 ? 'profit' : 'loss'}">
                        <div class="trade-info">
                            <div class="trade-symbol">${trade.symbol}</div>
                            <div class="trade-details">
                                ${_0x3e9d(trade.date)} ${timeInfo} • ${trade.quantity}x • 
                                R$ ${trade.entryPrice.toFixed(2)} → R$ ${trade.exitPrice.toFixed(2)}
                                ${notesInfo}
                            </div>
                        </div>
                        <div style="display: flex; align-items: center;">
                            <div class="trade-result ${trade.result >= 0 ? 'positive' : 'negative'}">
                                ${resultText}
                            </div>
                            <button class="delete-btn" onclick="_0x6e4f8a(${trade.id})">🗑️</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function _0x7b5e() {
            console.log('📅 Renderizando calendário...');
            
            const calendar = document.getElementById('calendar');
            const monthYear = document.getElementById('currentMonth');
            
            if (!calendar || !monthYear) {
                console.error('❌ Elementos do calendário não encontrados');
                return;
            }
            
            const year = _0x3c8f.getFullYear();
            const month = _0x3c8f.getMonth();
            
            const monthNames = [
                'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
            ];
            
            monthYear.textContent = `${monthNames[month]} ${year}`;
            
            // Clear calendar
            calendar.innerHTML = '';
            
            // Add day headers
            const dayHeaders = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
            dayHeaders.forEach(day => {
                const headerCell = document.createElement('div');
                headerCell.className = 'calendar-header-cell';
                headerCell.textContent = day;
                calendar.appendChild(headerCell);
            });
            
            // Get first day of month and start date
            const firstDay = new Date(year, month, 1);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            // Generate calendar days (6 weeks = 42 days)
            const current = new Date(startDate);
            for (let i = 0; i < 42; i++) {
                const dayCell = document.createElement('div');
                dayCell.className = 'calendar-day';
                
                const isCurrentMonth = current.getMonth() === month;
                const dateKey = current.toISOString().split('T')[0];
                const dayPnL = _0x5a7c[dateKey] || 0;
                
                if (!isCurrentMonth) {
                    dayCell.classList.add('other-month');
                } else if (dayPnL > 0) {
                    dayCell.classList.add('profit');
                } else if (dayPnL < 0) {
                    dayCell.classList.add('loss');
                } else {
                    dayCell.classList.add('neutral');
                }
                
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = current.getDate();
                dayCell.appendChild(dayNumber);
                
                if (isCurrentMonth && dayPnL !== 0) {
                    const pnlDisplay = document.createElement('div');
                    pnlDisplay.className = 'day-pnl';
                    pnlDisplay.textContent = _0x4e9f(dayPnL, true);
                    dayCell.appendChild(pnlDisplay);
                }
                
                calendar.appendChild(dayCell);
                current.setDate(current.getDate() + 1);
            }
            
            console.log('✅ Calendário renderizado com', calendar.children.length, 'elementos');
        }

        function _0x5e9a2c(direction) {
            if(_0x2a5f) { _0x9f2e(); return; }
            
            try {
                _0x3c8f.setMonth(_0x3c8f.getMonth() + direction);
                _0x7b5e();
            } catch(error) {
                console.error('Month navigation error:', error);
                // Reset to current month if error
                _0x3c8f = new Date();
                _0x7b5e();
            }
        }

        function _0x4e9f(value, short = false) {
            try {
                const absValue = Math.abs(value);
                const prefix = value >= 0 ? '' : '-';
                
                switch(_0x8e9f) {
                    case 'BRL':
                        return new Intl.NumberFormat('pt-BR', {
                            style: 'currency',
                            currency: 'BRL',
                            minimumFractionDigits: short ? 0 : 2
                        }).format(value);
                        
                    case 'USD':
                        return new Intl.NumberFormat('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            minimumFractionDigits: short ? 0 : 2
                        }).format(value);
                        
                    case 'PTS':
                        return `${prefix}${absValue.toFixed(short ? 0 : 1)} pts`;
                        
                    case 'PIPS':
                        return `${prefix}${absValue.toFixed(short ? 0 : 1)} pips`;
                        
                    default:
                        return `${prefix}${absValue.toFixed(2)}`;
                }
            } catch(error) {
                console.error('Currency format error:', error);
                return value.toFixed(2);
            }
        }

        function _0x3e9d(dateStr) {
            const date = new Date(dateStr + 'T00:00:00');
            return date.toLocaleDateString('pt-BR');
        }

        // Auto-calculate result
        document.getElementById('exitPrice').addEventListener('input', _0x6c9e);
        document.getElementById('entryPrice').addEventListener('input', _0x6c9e);
        document.getElementById('quantity').addEventListener('input', _0x6c9e);

        function _0x6c9e() {
            console.log('🧮 Calculando resultado automático...');
            
            const entryPrice = parseFloat(document.getElementById('entryPrice').value) || 0;
            const exitPrice = parseFloat(document.getElementById('exitPrice').value) || 0;
            const quantity = parseFloat(document.getElementById('quantity').value) || 0;
            const currency = document.getElementById('currency').value;
            
            console.log('Valores:', { entryPrice, exitPrice, quantity, currency });
            
            if (entryPrice && exitPrice && quantity) {
                let result = (exitPrice - entryPrice) * quantity;
                
                // Set precision based on currency type
                const precision = (currency === 'PTS' || currency === 'PIPS') ? 1 : 2;
                document.getElementById('result').value = result.toFixed(precision);
                
                console.log('Resultado calculado:', result);
                
                // Auto-select profit/loss button
                if (result > 0) {
                    _0x8d5f91('profit');
                } else if (result < 0) {
                    _0x8d5f91('loss');
                }
            }
        }

        // Auto-suggest currency based on asset
        document.getElementById('symbol').addEventListener('input', function(e) {
            if(_0x2a5f) { _0x9f2e(); return; }
            
            const _0x6c8f = e.target.value.toUpperCase();
            const _0x4e7d = document.getElementById('currency');
            
            // Auto-suggest currency based on asset
            if (_0x6c8f.includes('WIN') || _0x6c8f.includes('WDO') || _0x6c8f.includes('EUR')) {
                _0x4e7d.value = 'PTS';
                _0x8e9f = 'PTS';
            } else if (_0x6c8f.includes('USD') && (_0x6c8f.includes('EUR') || _0x6c8f.includes('GBP') || _0x6c8f.includes('AUD'))) {
                _0x4e7d.value = 'PIPS';
                _0x8e9f = 'PIPS';
            } else if (_0x6c8f.includes('USD') || _0x6c8f.includes('BTC') || _0x6c8f.includes('ETH')) {
                _0x4e7d.value = 'USD';
                _0x8e9f = 'USD';
            } else if (_0x6c8f.match(/^[A-Z]{4}[0-9]$/)) {
                // Brazilian stocks pattern (e.g., PETR4, VALE3)
                _0x4e7d.value = 'BRL';
                _0x8e9f = 'BRL';
            }
            
            // Update placeholder if currency changed
            _0x4f8c();
            localStorage.setItem('_0x7e8d', _0x8e9f);
        });

        // Auto-fill entry time on focus
        document.getElementById('symbol').addEventListener('focus', function() {
            if(_0x2a5f) { _0x9f2e(); return; }
            
            const _0x7e6d = document.getElementById('entryTime');
            if (!_0x7e6d.value) {
                const _0x5c9f = new Date();
                _0x7e6d.value = _0x5c9f.toTimeString().slice(0,5);
            }
        });

        // Initialize placeholder based on saved currency
        function _0x4f8c() {
            const resultField = document.getElementById('result');
            switch(_0x8e9f) {
                case 'BRL':
                    resultField.placeholder = '50.00';
                    break;
                case 'USD':
                    resultField.placeholder = '10.50';
                    break;
                case 'PTS':
                    resultField.placeholder = '25.0';
                    break;
                case 'PIPS':
                    resultField.placeholder = '15.5';
                    break;
            }
        }

        // Force immediate initialization - CACHE BUSTER v2.1
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 REMORA TRADER - Inicializando v2.1');
            
            // Force set today's date
            const today = new Date();
            document.getElementById('date').valueAsDate = today;
            
            // Force currency load
            const savedCurrency = localStorage.getItem('_0x7e8d') || 'BRL';
            document.getElementById('currency').value = savedCurrency;
            _0x8e9f = savedCurrency;
            
            // Force placeholder update
            _0x4f8c();
            
            // Force dashboard update
            setTimeout(() => {
                _0x3d8e();
                console.log('✅ Dashboard atualizado');
            }, 200);
            
            // Force calendar update
            setTimeout(() => {
                _0x7b5e();
                console.log('📅 Calendário renderizado');
            }, 400);
        });

        // Also run initialization immediately
        setTimeout(() => {
            const today = new Date();
            document.getElementById('date').valueAsDate = today;
            _0x4f8c();
            _0x3d8e();
        }, 50);

        // Focus hint for new users
        if (_0x7f4e.length === 0) {
            setTimeout(() => {
                if (_0x7f4e.length === 0 && !_0x2a5f) {
                    document.getElementById('symbol').focus();
                }
            }, 1000);
        }

        // Console protection
        setInterval(() => {
            console.clear();
            console.log('%c ', 'font-size: 1px;');
        }, 1000);

        // Final integrity check
        setTimeout(() => {
            if(_0x8c4e() !== _0x6f3e || _0x2a5f) {
                _0x9f2e();
            } else {
                // Force refresh calendar if empty
                const calendarDays = document.querySelectorAll('.calendar-day');
                if (calendarDays.length === 0) {
                    _0x7b5e();
                }
                console.log('🎯 REMORA TRADER v2.1 - Totalmente carregado!');
            }
        }, 3000);
        
        // VERSION STAMP: 2025-07-01-16:30 REMORA TRADER v2.1
        
    </script>
</body>
</html>